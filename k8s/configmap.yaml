apiVersion: v1
kind: ConfigMap
metadata:
  name: agentgateway-config
  namespace: agentgateway
  labels:
    app: agentgateway
data:
  config.yaml: |
    # AgentGateway Configuration for Kubernetes Deployment
    config:
      adminAddr: "0.0.0.0:15000"
      logging:
        format: json
        level: info
        fields:
          add:
            service: '"agentgateway"'
            version: '"1.0.0"'
    binds:
    - port: 3000
      listeners:
      - name: main
        routes:
        # Health check route - must come first to match before catch-all
        - name: health
          matches:
          - path:
              exact: /health
          policies:
            directResponse:
              body: '{"status":"healthy","service":"agentgateway"}'
              status: 200
        # Main AI route - catch-all for other requests
        - name: main
          policies:
            cors:
              allowOrigins:
              - "*"
              allowHeaders:
              - "content-type"
              - "authorization"
              - "cache-control"
              - "mcp-protocol-version"
              exposeHeaders:
              - "Mcp-Session-Id"
          backends:
          - ai:
              name: default
              provider:
                openAI:
                  model: gpt-4o-mini